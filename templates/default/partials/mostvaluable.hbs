{{#if mostValuableKills}}
{{#> components/collapsible-section id="most-valuable-kills" title=(concat "Most Valuable Kills " (fallback (concat "(" timeRange ")") "(All Time)"))}}
    {{#if mostValuableKills.length}}
    <div style="padding: 8px 12px;">
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px; width: 100%;">
            {{#each mostValuableKills}}
            <div>
                <div style="min-height: 225px; cursor: pointer; display: flex; flex-direction: column; background: rgba(0, 0, 0, 0.2); border: 1px solid var(--color-border-dark); border-radius: var(--radius-sm); overflow: hidden; transition: all 0.2s ease;" data-killmail-id="{{this.killmailId}}" onmouseover="this.style.borderColor='var(--color-accent-blue-light)'; this.style.boxShadow='0 0 8px rgba(74, 158, 255, 0.3)'" onmouseout="this.style.borderColor='var(--color-border-dark)'; this.style.boxShadow='none'" onclick="window.location.href='/killmail/{{this.killmailId}}';">
                    <div style="position: relative; width: 100%; height: 140px; background: linear-gradient(135deg, rgba(74, 158, 255, 0.1), rgba(74, 158, 255, 0.05)); display: flex; align-items: center; justify-content: center; overflow: hidden;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center;">
                            {{> partials/eve-image type="ship" id=victim.ship.typeId size=256 alt=victim.ship.name style="width: 100%; height: 100%; object-fit: contain;"}}
                        </div>
                        <div style="position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent); padding: 4px 8px 3px 8px; font-size: 9px; font-weight: 600; color: var(--color-text-white); text-overflow: ellipsis; white-space: nowrap; overflow: hidden;">
                            {{victim.ship.name}}
                        </div>
                    </div>

                    <div style="padding: 10px 12px; display: flex; flex-direction: column; flex: 1;">
                        <div style="margin-bottom: 2px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; line-height: 1.3;">
                            {{#if victim.character.id}}
                            <a href="/character/{{victim.character.id}}" style="color: #4a9eff; text-decoration: none; font-size: 11px; font-weight: 600; display: block;" data-character-id="{{victim.character.id}}" onclick="event.stopPropagation();">
                                {{victim.character.name}}
                            </a>
                            {{else}}
                            <span style="color: #4a9eff; font-size: 11px; font-weight: 600; display: block;">
                                {{victim.ship.name}}
                            </span>
                            {{/if}}
                        </div>

                        <div style="margin-bottom: 8px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; line-height: 1.3;"{{#if victim.corporation.id}} data-corporation-id="{{victim.corporation.id}}"{{/if}}>
                            {{#if victim.corporation.id}}
                            <a href="/corporation/{{victim.corporation.id}}" style="color: var(--color-text-secondary); text-decoration: none; font-size: 9px; display: block;" onclick="event.stopPropagation();">
                                {{victim.corporation.ticker}}
                            </a>
                            {{else}}
                            <span style="color: var(--color-text-secondary); font-size: 9px;">Unknown</span>
                            {{/if}}
                        </div>

                        <div style="margin-top: auto; padding-top: 6px;">
                            <div style="color: #4ade80; font-weight: 700; font-size: 11px; line-height: 1.3; margin-bottom: 2px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{abbreviateISK totalValue}}</div>
                            <div style="font-size: 9px; color: var(--color-text-secondary); line-height: 1.3;">
                                {{formatDate killmailTime}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {{/each}}
        </div>
    </div>
    {{else}}
    <div style="padding: 40px 20px; text-align: center; color: var(--color-text-secondary); font-size: 11px;">
        No valuable kills found.
    </div>
    {{/if}}
{{/components/collapsible-section}}
{{/if}}
